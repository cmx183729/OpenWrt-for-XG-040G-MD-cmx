#
# ============================================================
#   OpenWrt Config for Nokia XG-040G-MD
#   Mode: EQoS Plus (支持NPU加速) | Clean & Stable
# ============================================================
#

# --- 1. 目标平台与硬件定义 ---
CONFIG_TARGET_airoha=y
CONFIG_TARGET_airoha_an7581=y
CONFIG_TARGET_airoha_an7581_DEVICE_bell_xg-040g-md=y
CONFIG_ARCH_64BIT=y
CONFIG_aarch64=y
CONFIG_LINUX_6_12=y

# 硬件驱动
CONFIG_PACKAGE_airoha-en7581-npu-firmware=y
CONFIG_PACKAGE_kmod-phy-airoha-en8811h=y
CONFIG_PACKAGE_kmod-i2c-an7581=y

# --- 2. 基础系统设置 ---
CONFIG_DEFAULT_base-files=y
CONFIG_DEFAULT_busybox=y
CONFIG_DEFAULT_ca-bundle=y
CONFIG_DEFAULT_logd=y
CONFIG_DEFAULT_procd=y
CONFIG_DEFAULT_uci=y
CONFIG_DEFAULT_urandom-seed=y
CONFIG_DEFAULT_urngd=y
CONFIG_DEFAULT_netifd=y
CONFIG_DEFAULT_mtd=y
CONFIG_DEFAULT_fstools=y
CONFIG_DEFAULT_block-mount=y
CONFIG_DEFAULT_libc=y
CONFIG_DEFAULT_libgcc=y
CONFIG_PACKAGE_uboot-envtools=y
CONFIG_PACKAGE_uclient-fetch=y
CONFIG_PACKAGE_kmod-gpio-button-hotplug=y
CONFIG_PACKAGE_kmod-leds-gpio=y
CONFIG_PACKAGE_ubi-utils=y

# 分区调整
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_SQUASHFS_BLOCK_SIZE=256
CONFIG_TARGET_SQUASHFS_BLOCK_READERS=4
CONFIG_TARGET_SQUASHFS_SMALL_READERS=4
CONFIG_TARGET_UBIFS_FREE_SPACE_FIXUP=y
CONFIG_MTD_UBI=y
CONFIG_UBIFS_FS=y
CONFIG_FSTOOLS_UBIFS_EXTROOT=y
CONFIG_TARGET_ROOTFS_PARTSIZE=256

# --- 3. 网络基础 ---
CONFIG_IPV6=y
CONFIG_PACKAGE_dnsmasq=y
CONFIG_PACKAGE_ip-full=y
CONFIG_DEFAULT_odhcp6c=y
CONFIG_DEFAULT_odhcpd-ipv6only=y
CONFIG_PACKAGE_nftables=y
CONFIG_PACKAGE_firewall4=y
CONFIG_PACKAGE_kmod-nfnetlink=y
CONFIG_PACKAGE_kmod-nft-core=y
CONFIG_PACKAGE_kmod-nft-nat=y
CONFIG_PACKAGE_kmod-nf-flow=y
CONFIG_PACKAGE_ethtool-full=y

# [核心加速] EQoS Plus 通常支持硬件卸载，所以我们把 NPU 加速开回来！
CONFIG_PACKAGE_kmod-nft-offload=y
CONFIG_PACKAGE_kmod-tcp-bbr=y

# --- 4. 包管理器 ---
CONFIG_PACKAGE_apk=y
CONFIG_DEFAULT_apk-tools=y
CONFIG_PACKAGE_apk-mbedtls=y
CONFIG_DEFAULT_openwrt-keyring=y

# ============================================================
#   用户插件区 (User Plugins)
# ============================================================

# --- [1] 科学上网 (Passwall) ---
CONFIG_PACKAGE_luci-app-passwall=y
CONFIG_PACKAGE_luci-i18n-passwall-zh-cn=y
# CONFIG_PACKAGE_trojan-plus is not set
# CONFIG_PACKAGE_luci-app-passwall_INCLUDE_Trojan_Plus is not set

# --- [2] 端口转发 (Lucky) ---
CONFIG_PACKAGE_luci-app-lucky=y
CONFIG_PACKAGE_luci-i18n-lucky-zh-cn=y

# --- [3] IPTV 转换 (rtp2httpd) ---
CONFIG_PACKAGE_luci-app-rtp2httpd=y

# --- [4] 自动端口映射 (UPnP) ---
CONFIG_PACKAGE_miniupnpd=y
CONFIG_PACKAGE_luci-app-upnp=y
CONFIG_PACKAGE_luci-i18n-upnp-zh-cn=y

# --- [5] 内存优化 (ZRAM) ---
CONFIG_PACKAGE_zram-swap=y
CONFIG_PACKAGE_luci-app-zram=y
CONFIG_PACKAGE_luci-i18n-zram-zh-cn=y

# --- [6] 定时重启 (Watchcat) ---
CONFIG_PACKAGE_luci-app-watchcat=y
CONFIG_PACKAGE_luci-i18n-watchcat-zh-cn=y

# --- [7] 增强版流控 (EQoS Plus) ---
# 使用 Sirpdboy 的增强版，功能更强
CONFIG_PACKAGE_luci-app-eqosplus=y
# (通常 Sirpdboy 的包自带中文，如果编译报错找不到zh-cn包，可以把下面这行注释掉)
CONFIG_PACKAGE_luci-i18n-eqosplus-zh-cn=y

# --- [8] IP/MAC 绑定 (Arpbind) ---
CONFIG_PACKAGE_luci-app-arpbind=y
CONFIG_PACKAGE_luci-i18n-arpbind-zh-cn=y

# --- [9] 流量统计 (Nlbwmon) ---
CONFIG_PACKAGE_luci-app-nlbwmon=y
CONFIG_PACKAGE_luci-i18n-nlbwmon-zh-cn=y

# --- [10] 界面主题 (Argon) ---
CONFIG_PACKAGE_luci-theme-argon=y

# --- [11] 网页终端 (Ttyd) ---
CONFIG_PACKAGE_luci-app-ttyd=y
CONFIG_PACKAGE_luci-i18n-ttyd-zh-cn=y

# --- [12] 常用工具 ---
CONFIG_PACKAGE_nano=y
CONFIG_PACKAGE_htop=y
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget-ssl=y
CONFIG_PACKAGE_bash=y

# ============================================================
#   系统组件
# ============================================================
CONFIG_PACKAGE_ppp=y
CONFIG_PACKAGE_ppp-mod-pppoe=y
CONFIG_PACKAGE_dropbear=y
CONFIG_DROPBEAR_SMALL_CODE=y
CONFIG_DROPBEAR_ED25519=y
CONFIG_DROPBEAR_CURVE25519=y
CONFIG_PACKAGE_openssh-sftp-server=y
CONFIG_PACKAGE_luci=y
CONFIG_LUCI_LANG_zh_Hans=y
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y
CONFIG_PACKAGE_luci-compat=y
